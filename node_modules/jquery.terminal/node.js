const jsdom = require("jsdom");
const { JSDOM } = jsdom;

const { window } = new JSDOM(`<html></html>`);

global.window = window;

global.location = global.window.location = {hash: ''};
global.document = window.document;
global.Element = window.Element;
global.jQuery = global.$ = require("jquery");
global.wcwidth = require('wcwidth');

global.navigator = {userAgent: 'Node.js'};

require('./js/jquery.terminal-src')($);
require('./js/prism')($);

$.terminal.new_formatter(function(str) {
    return str
        .replace(/(foo)/g, '[[;black;rebeccapurple;;;{"style": ""}]$1]')
        .replace(/(bar)/g, '[[;black;rebeccapurple;;;{"style": "--size: 1"}]$1]');
});

var input = '[[ub;#fff;]>>>][[;;] ]';
input = '黒[[;;]です]';
var output = $.terminal.format(input);
console.log(output);

/*

var input = '[[;green;;;;{"style": ""}]Foo]';
var output = $.terminal.format(input, {
    allowedAttributes: ['style']
});

console.log(output);

var input = '[[;green;;;;{"style": ""}]Foo]';
var output = $.terminal.format(input, {
    allowedAttributes: []
});

console.log(output);

//console.log($.terminal.prism('html', '<x>xxx</x>'));


*/
